<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Diary Pro - Plan vs Reality Tracker</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
      window.SUPABASE_URL = 'https://dfinivpcjzrvqhmxwqyv.supabase.co';
      window.SUPABASE_ANON_KEY = 'sb_publishable_cAc5XykobeYO7EhZFwOKAw_FDtE6B21';
      window.supabase = supabase.createClient(window.SUPABASE_URL, window.SUPABASE_ANON_KEY);
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-row">
                <div class="date-controls">
                    <button id="prevDayBtn">&lt;</button>
                    <input type="date" id="dateInput">
                    <button id="nextDayBtn">&gt;</button>
                    <button id="todayBtn">Today</button>
                </div>
                <div class="main-actions">
                    <button id="copyYesterdayBtn">ðŸ“‹ Yesterday</button>
                    <button id="templatesBtn">ðŸ“„ Templates</button>
                    <button id="summaryBtn">ðŸ“Š Summary</button>
                    <button id="reflectBtn">ðŸ’­ Reflect</button>
                    <button id="saveBtn">ðŸ’¾ Save</button>
                </div>
            </div>
            <div class="export-import-controls">
                <button id="exportJsonBtn">ðŸ“¥ Export JSON</button>
                <button id="exportCsvBtn">ðŸ“¥ Export CSV</button>
                <input type="file" id="importFile" accept=".json,.csv" style="display: none;">
                <button id="importBtn">ðŸ“¤ Import</button>
            </div>
        </div>

        <div id="templatesPanel" class="panel hidden">
            <div class="panel-header">
                <h2 class="panel-title">Templates</h2>
                <button id="saveTemplateBtn">Save Current as Template</button>
            </div>
            <div id="templateGrid" class="template-grid"></div>
        </div>

        <div id="summaryPanel" class="panel hidden">
            <div class="panel-header">
                <h2 class="panel-title">Summary</h2>
                <div class="view-mode-toggle">
                    <button id="dailyViewBtn" class="active">Daily</button>
                    <button id="weeklyViewBtn">Weekly</button>
                </div>
            </div>
            <div id="dailySummaryView">
                <div class="summary-grid">
                    <div class="summary-box">
                        <div class="summary-value" id="totalPlanned">0h</div>
                        <div class="summary-label">Planned</div>
                    </div>
                    <div class="summary-box">
                        <div class="summary-value" id="totalActual">0h</div>
                        <div class="summary-label">Actual</div>
                    </div>
                    <div class="summary-box">
                        <div class="summary-value" id="totalDrift">+0h</div>
                        <div class="summary-label">Drift</div>
                    </div>
                    <div class="summary-box">
                        <div class="summary-value" id="efficiency">0%</div>
                        <div class="summary-label">Efficiency</div>
                    </div>
                </div>
                <div class="avg-energy-box">
                    âš¡ Avg Energy: <span id="avgEnergy">3.0</span>/5
                </div>
                <div id="projectList" class="project-list"></div>
            </div>
            <div id="weeklySummaryView" class="hidden">
                <h3>7-Day Overview</h3>
                <div id="weeklyGrid" class="weekly-grid"></div>
                <h4>Project Breakdown (7 days)</h4>
                <div id="weeklyProjects" class="project-list"></div>
            </div>
        </div>

        <div id="reflectionPanel" class="panel hidden">
            <h2 class="panel-title">Daily Reflection</h2>
            <textarea id="reflectionText" rows="4" placeholder="What did you learn today? What went well? What could be improved?"></textarea>
        </div>

        <div id="bulkPanel" class="panel hidden">
            <div class="bulk-controls">
                <div class="selected-count"><span id="selectedCount">0</span> blocks selected</div>
                <input type="text" id="bulkProjectInput" list="projectsDatalist" placeholder="Project tag">
                <button id="applyBulkProjectBtn">Apply to Selected</button>
                <button id="clearSelectionBtn">Clear</button>
            </div>
        </div>

        <div class="time-grid">
            <div class="time-grid-header">
                <div class="header-cell-checkbox"><input type="checkbox" id="selectAllCheckbox"></div>
                <div class="header-cell">Time</div>
                <div class="header-cell">Plan</div>
                <div class="header-cell">Reality</div>
                <div class="header-cell">Project &amp; Energy</div>
            </div>
            <div class="time-grid-body" id="timeGridBody"></div>
        </div>
    </div>

    <div id="toast" class="toast hidden"></div>
    <datalist id="projectsDatalist"></datalist>

    <script src="script.js"></script>
</body>
</html>